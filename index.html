<!-- index.html -->
<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width,initial-scale=1,viewport-fit=cover"
    />
    <title>50MB Video Recorder / Converter (MP4-first)</title>

    <link rel="stylesheet" href="main.css" />
  </head>
  <body>
    <header>
      <div class="row">
        <h1>50MB Video Recorder / Converter</h1>
        <div class="row" style="gap: 8px">
          <button id="settingsBtn" class="btn" type="button">
            ‚öôÔ∏è Settings
          </button>
          <button id="themeBtn" class="btn" type="button">üåì Theme</button>
        </div>
      </div>
    </header>

    <main>
      <section class="card">
        <h2>
          <span>Record / Upload</span>
          <span class="pill"
            >Limit: <span class="mono" id="limitLabel">50.0 MB</span></span
          >
        </h2>

        <div class="content">
          <div id="secureBanner" class="banner" style="display: none">
            <div class="bannerTitle warn">iPhone camera needs HTTPS</div>
            <p>
              If you opened this from <span class="mono">Files</span> (file://),
              iPhone will usually block the camera. Host this page on HTTPS and
              open it in Safari.
            </p>
          </div>

          <div id="mp4Banner" class="banner" style="display: none">
            <div class="bannerTitle warn">MP4 encoding not supported here</div>
            <p>
              This browser/device can‚Äôt encode MP4 via MediaRecorder. Output
              will be WebM, which GorillaDesk won‚Äôt accept. Use iPhone Safari
              over HTTPS (often supports MP4), or use FFmpeg/server conversion.
            </p>
          </div>

              <!-- Concise camera enable group -->
            <div class="groupCard" id="cameraGroup">
              <div class="groupTop">
                <div class="groupTitle">Camera</div>
                <div class="groupSub mono" id="cameraStateLabel">
                  Not enabled
                </div>
              </div>

              <div class="actions tight">
                <button id="enableCameraBtn" class="btn primary" type="button">
                  üì∑ Enable
                </button>
                <button
                  id="restartPreviewBtn"
                  class="btn"
                  type="button"
                  disabled
                >
                  üîÑ Restart
                </button>
              </div>

              <div class="note" style="margin-top: 8px">
                Tip: iPhone Safari requires HTTPS for camera access.
              </div>
            </div>

          <div class="tabs" role="tablist" aria-label="mode tabs">
            <button
              id="tabRecord"
              class="tab active"
              type="button"
              role="tab"
              aria-selected="true"
            >
              üé• Record
            </button>
            <button
              id="tabUpload"
              class="tab"
              type="button"
              role="tab"
              aria-selected="false"
            >
              üìÅ Upload
            </button>
          </div>

          <!-- Record Panel -->
          <div id="recordPanel" style="margin-top: 12px">
            <video id="preview" playsinline autoplay muted></video>

        

            <!-- Recording group -->
            <div class="groupCard" id="recordingGroup">
              <div class="groupTop">
                <div class="groupTitle">Recording</div>
                <div class="groupSub mono" id="recStateLabel">Idle</div>
              </div>

              <div class="status compact" aria-live="polite">
                <span class="pill"
                  >Size:
                  <span class="mono" id="recSizeLabel">0.0 MB</span></span
                >
                <span class="pill"
                  >Time: <span class="mono" id="recTimeLabel">0s</span></span
                >
                <span class="pill"
                  >Torch: <span class="mono" id="torchLabel">n/a</span></span
                >
                <span class="pill"
                  >Zoom: <span class="mono" id="zoomLabel">n/a</span></span
                >
              </div>

              <div
                class="bar"
                title="Recorded size vs 50MB (can exceed while recording)"
              >
                <div id="recBarFill"></div>
              </div>

              <div class="actions tight">
                <!-- Start/Stop is ONE button -->
                <button
                  id="recordToggleBtn"
                  class="btn primary"
                  type="button"
                  disabled
                >
                  ‚è∫Ô∏è Record
                </button>

                <!-- Pause next to it -->
                <button id="pauseBtn" class="btn" type="button" disabled>
                  ‚è∏Ô∏è Pause
                </button>

                <button id="resetBtn" class="btn" type="button" disabled>
                  üßπ Reset
                </button>
              </div>

              <div class="note">
                Record as long as you want. After you stop, Convert can compress
                to ‚â§ 50MB.
              </div>
            </div>
          </div>

          <!-- Upload Panel -->
          <div id="uploadPanel" style="display: none; margin-top: 12px">
            <div class="groupCard">
              <div class="groupTop">
                <div class="groupTitle">Upload</div>
                <div class="groupSub mono">Pick a video file</div>
              </div>
              <label for="fileInput"
                >Choose a video (MP4/MOV recommended)</label
              >
              <input id="fileInput" type="file" accept="video/*" />
              <div class="note">
                Pick an existing video and convert it to ‚â§ 50MB.
              </div>
            </div>
          </div>

          <hr
            style="
              border: none;
              border-top: 1px solid var(--border);
              margin: 14px 0;
            "
          />

          <div class="status">
            <span class="pill"
              >Preferred output:
              <span class="mono" id="preferredMimeLabel">‚Äî</span></span
            >
            <span class="pill"
              >GorillaDesk compatible:
              <span class="mono" id="gdCompatLabel">‚Äî</span></span
            >
          </div>

          <!-- Convert group -->
          <div class="groupCard" id="convertGroup" style="margin-top: 12px">
            <div class="groupTop">
              <div class="groupTitle">Convert & Save</div>
              <div class="groupSub mono" id="convertStateLabel">Ready</div>
            </div>

            <div class="actions tight">
              <button
                id="convertBtn"
                class="btn primary"
                type="button"
                disabled
              >
                üß™ Convert ‚â§ 50MB
              </button>
              <button id="cancelConvertBtn" class="btn" type="button" disabled>
                ‚úã Cancel
              </button>
            </div>

            <div id="progressBox" class="progressBox">
              <div class="progressTop">
                <div>Attempt: <span class="mono" id="attemptText">‚Äî</span></div>
                <div>Status: <span class="mono" id="progressText">‚Äî</span></div>
              </div>
              <div class="log mono" id="progressLog"></div>
            </div>

            <div id="resultArea" style="margin-top: 12px">
              <div class="note">
                Converted output will appear here with Save/Share.
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- hidden helper elements -->
      <div class="hiddenTools">
        <canvas id="xCanvas"></canvas>
        <video id="xVideo" playsinline muted></video>
      </div>
    </main>

    <!-- Settings Sheet -->
    <div id="sheetOverlay" class="sheetOverlay"></div>
    <div
      id="sheet"
      class="sheet"
      aria-hidden="true"
      role="dialog"
      aria-modal="true"
    >
      <div class="sheetHeader">
        <h3>Settings</h3>
        <button id="closeSheetBtn" class="btn" type="button">‚úñÔ∏è Close</button>
      </div>
      <div class="sheetBody">
        <div class="twoCol">
          <div>
            <label for="cameraSelect">Camera</label>
            <select id="cameraSelect"></select>
          </div>
          <div>
            <label for="fpsSelect">FPS (record & convert)</label>
            <select id="fpsSelect">
              <option value="30" selected>30</option>
              <option value="24">24</option>
              <option value="20">20</option>
              <option value="15">15</option>
            </select>
          </div>
        </div>

        <div class="twoCol">
          <div>
            <label for="previewResSelect">Preview Resolution (camera)</label>
            <select id="previewResSelect">
              <option value="1280x720" selected>720p (1280√ó720)</option>
              <option value="854x480">480p (854√ó480)</option>
              <option value="640x360">360p (640√ó360)</option>
            </select>
          </div>
          <div>
            <label for="convertResSelect">Convert Max Resolution</label>
            <select id="convertResSelect">
              <option value="1280x720" selected>720p max</option>
              <option value="854x480">480p max</option>
              <option value="640x360">360p max</option>
              <option value="426x240">240p max</option>
            </select>
          </div>
        </div>

        <div>
          <label for="recordBitrate"
            >Recording bitrate (kbps):
            <span class="mono" id="recordBitrateLabel">1500</span></label
          >
          <input
            id="recordBitrate"
            type="range"
            min="250"
            max="8000"
            step="50"
            value="1500"
          />
          <div class="note">
            This affects raw recording size. Final size is controlled during
            conversion.
          </div>
        </div>

        <div>
          <label for="minQualitySelect"
            >Minimum quality floor (conversion)</label
          >
          <select id="minQualitySelect">
            <option value="640x360|250" selected>Min 360p @ 250 kbps</option>
            <option value="426x240|180">Min 240p @ 180 kbps</option>
            <option value="320x180|120">Min 180p @ 120 kbps</option>
          </select>
        </div>

        <div class="twoCol">
          <div>
            <label>Camera Controls</label>
            <button id="torchBtn" class="btn" type="button" disabled>
              üî¶ Torch: n/a
            </button>
            <div class="note">Torch works only on some rear cameras.</div>
          </div>
          <div>
            <label for="zoomRange"
              >Zoom: <span class="mono" id="zoomValue">n/a</span></label
            >
            <input
              id="zoomRange"
              type="range"
              min="1"
              max="1"
              step="0.1"
              value="1"
              disabled
            />
            <div class="note">Zoom depends on camera capabilities.</div>
          </div>
        </div>

        <div class="note">
          MP4 output requires MP4 encoding support from your browser
          (MediaRecorder). If unsupported, this app will fall back to WebM.
        </div>
      </div>
    </div>

    <!-- Preview Modal -->
    <div id="modalOverlay" class="modalOverlay" hidden></div></div>
    <!-- <div
      id="videoModal"
      class="modal"
      hidden
      inert
      role="dialog"
      aria-modal="true"
    >
      <div class="modalHeader">
        <h3>Preview</h3>
        <button id="closeModalBtn" class="btn" type="button">‚úñÔ∏è Close</button>
      </div>
      <div class="modalBody">
        <video id="modalVideo" controls playsinline></video>
        <div class="note" id="modalMetaNote"></div>
      </div>
    </div> -->

    <script src="./main.js"></script>
  </body>
</html>
